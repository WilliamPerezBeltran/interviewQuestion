
-----------------------------------------------------------------------------------------------------------------
14. Que es definion sesion y cockies y como se manejan en ruby on rails ? 
14.1  Historia del concepto / ¿ Por qué lo inventaron ?
14.2  Ventajas: 
14.3  Desventajas: 
14.4 Ejemplo en producción 


# Sesiones y Cookies en Ruby on Rails

## Concepto

**Sesión:** Una sesión es un mecanismo que permite a una aplicación web almacenar información específica de un usuario entre diferentes solicitudes HTTP. Rails mantiene la información de la sesión en el servidor y se identifica mediante un `session_id` que se envía al cliente.

**Cookies:** Una cookie es un pequeño archivo que el servidor envía al navegador del usuario para almacenar datos localmente. Rails usa cookies para identificar sesiones y almacenar información persistente entre solicitudes.

## Historia del concepto / Por qué lo inventaron

El HTTP es un protocolo sin estado, lo que significa que cada solicitud es independiente. Las sesiones y cookies fueron inventadas para mantener el estado entre solicitudes, permitiendo que las aplicaciones web recuerden información del usuario, como autenticación, preferencias y carrito de compras.

## Ejemplo

```ruby
# Configuración de sesión en Rails (config/initializers/session_store.rb)
Rails.application.config.session_store :cookie_store, key: '_mi_app_session'

# Uso de sesión en un controlador
class UsersController < ApplicationController
  def login
    user = User.find_by(email: params[:email])
    if user&.authenticate(params[:password])
      session[:user_id] = user.id
      redirect_to dashboard_path
    else
      render :new
    end
  end

  def logout
    session.delete(:user_id)
    redirect_to root_path
  end
end

# Uso de cookies
cookies[:user_name] = { value: 'William', expires: 1.hour.from_now }
user_name = cookies[:user_name]
```

## Ventajas

* Permiten mantener estado en aplicaciones web sin depender de URLs.
* Facilitan la autenticación y personalización de la experiencia del usuario.
* Rails proporciona métodos fáciles de usar para manejar sesiones y cookies.

## Desventajas

* Las cookies pueden ser manipuladas por el usuario; por eso deben ser firmadas o encriptadas.
* Almacenar demasiada información en la cookie puede afectar el rendimiento.
* Las sesiones almacenadas en memoria pueden consumir recursos del servidor.

## Ejemplo en producción

En una tienda en línea:

* La sesión almacena el ID del usuario y el carrito de compras mientras navega por la web.
* Cookies recuerdan preferencias del usuario como el idioma o el tema de la interfaz.
* Rails asegura que la cookie de sesión esté firmada para evitar manipulaciones.

```ruby
# Aplicación real: carrito de compras
class CartsController < ApplicationController
  def add_item
    session[:cart] ||= []
    session[:cart] << params[:product_id]
    redirect_to cart_path
  end
end
```