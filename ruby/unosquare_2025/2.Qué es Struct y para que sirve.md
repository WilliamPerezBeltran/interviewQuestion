

-----------------------------------------------------------------------------------------------------------------
2.  Qué es Struct y para que sirve 
En ruby un "Struct" es un clase especial que permite crear objectos ligeros con 
un conjunto fijo de atributos son necesidad de definir manualmente una clase completa. 
Sirve como una forma rápida y práctica de agrupar datos relacionados bajo un mismo objeto .
	
2.1  Historia del concepto / ¿ Por qué lo inventaron ?
Struct fue introducido en ruby o para ofrecer una alternativa mas sencilla y menos 
"verborsa " que definir clases completas. La idea viene de los lenguajes como C, donde un 
"struct"	agrupa variables elacionadas en una sola entidad. En ruby , se creó para agilizar 
la creación de objectos tipo "data container" sin sobrecargar el código con lógica extra.

ejemplo:
```ruby

# crear Struct 
Person = Struct.new(:name,:age)

#instanciar un objecto de ese Struct
p1 = Person.new("jose",23)

p p1.name 
p p1.age 

```
2.2  Ventajas: 
- menos código que una clase tradicional . 
- Permite definir atrivutos y métodos ráidamente 
- Ideal para objetos que solo amacenan datos 
- Se pueden añadir métodos si es necesario 

2.3  Desventajas: 
- No estn flexible como una clase completa 
- puede ser dícil de mantener en proyectos grandes . 
- Menos expresivo es el modelo de datos necesita validciones o lícigoca compleja

2.4 Ejemplo en producción 
Un uso común de Struct en producción es en APIs o procesamiento de datos, cuando 
se necesita mapear resultados rápidos:

```ruby 
# Resultado de un servicio externo
ApiResult = Struct.new(:status, :message)

response = ApiResult.new(200, "Success")

if response.status == 200
  puts "API call ok: #{response.message}"
end

```
2.4 produccion  ste patrón se utiliza en producción, por ejemplo, en scripts de 
Ruby dentro de Rails para encapsular respuestas de servicios internos o externos 
de forma ligera.

otro Ejemplo en producción (o en código real)

Un ejemplo interesante aparece en un hilo de StackOverflow, donde alguien mezcla 
Struct con ActiveRecord para objetos ligeros que no necesitan persistencia en base 
de datos.

Stack Overflow
```ruby 
class OtherThing < ActiveRecord::Base
  # Definen un Struct dentro de la clase para representar objetos sin db
  OtherThing = Struct.new(:id, :name, :age, :monkey_fighting_ability)

  belongs_to :thing, class_name: 'Thing'

  def self.search_for(something)
    MY_GLOBAL_HASH[something].map do |hash|
      instance = OtherThing.new
      hash.each_pair do |k, v|
        instance.send(:"#{k}=", v)
      end
      instance
    end
  end

  # Simulan que el Struct responde a `save` para mezclarlo fácilmente
  def save
    true
  end
  alias save save!

  protected

  def something
    self.errors.add(:monkey_fighting_ability, 'must be unlimited') if self.class.search_for(something).empty?
  end
end

```

En ese ejemplo:
 - Se crea un Struct llamado OtherThing con atributos simples.
 - Se usa dentro de una clase ActiveRecord para manejar datos no persistentes.
 - Se sobrecarga save para que el Struct "finja" que tiene comportamiento de modelo, 
 aunque no persista nada.
 - Este patrón aparece cuando necesitas mezclar datos "ligeros" (por ejemplo, resultados 
 externos, datos calculados) 
 junto con tus modelos persistentes, sin tener que crear tablas nuevas para esos datos.

2.5 Ejemplo real de las pruebas internas de Rails donde usan Struct: 
Ejemplo real en código de Rails (pruebas)

En la issue "Nested fields_for in form_with without model produce …" del repositorio de Rails, 
se define un Struct llamado 
ArgsStruct dentro de una clase de pruebas:

url produccion:
https://github.com/rails/rails/issues/54604?utm_source=chatgpt.com

```ruby
ArgsStruct = Struct.new(:foo, :bar)

def test_stuff
  args = ArgsStruct.new("foo", "bar")

  render inline: <<~ERB, locals: { args: args }
    <%= form_with url: "/some_path" do |form| %>
      <%= form.fields_for :args, args do |fields| %>
        <%= fields.text_field :foo %>
        <%= fields.text_field :bar %>
      <% end %>
      <%= form.submit %>
    <% end %>
  ERB
  ...
end
```
Este fragmento aparece en Rails mismo, como parte de los tests / casos de prueba del framework.
GitHub: 

Lo que hace allí:
- Usan ArgsStruct como un objeto ligero (sin ActiveRecord) que se pasa como locals al renderizado.
- Permiten que el helper de formulario (fields_for) trate ese Struct como un "modelo" para generar 
campos foo y bar.
- Sirve para probar que la funcionalidad de formularios funciona correctamente incluso cuando el objeto 
no es un modelo persistente.						
