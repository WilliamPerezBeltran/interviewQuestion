

-----------------------------------------------------------------------------------------------------------------
13. Que es definion de routes en rails en detalle
13.1  Historia del concepto / ¿ Por qué lo inventaron ?
13.2  Ventajas: 
13.3  Desventajas: 
13.4 Ejemplo en producción 

definion de routes en rails en detalle

# Routes en Ruby on Rails

## Concepto

En Ruby on Rails, las **routes** (rutas) son la forma de mapear solicitudes HTTP (como GET, POST, PUT, DELETE) a acciones específicas de los controladores. Definen cómo se accede a las distintas partes de una aplicación web, permitiendo que una URL se conecte con la lógica del servidor.

## Historia del concepto / Por qué lo inventaron

Las rutas fueron introducidas en Rails para simplificar el manejo de URLs y la conexión de la lógica del servidor con la interfaz web. Antes de Rails, los frameworks requerían definir manualmente la relación entre URLs y funciones del servidor, lo que resultaba repetitivo y propenso a errores. Rails implementó un **sistema de rutas declarativo**, facilitando la organización y el mantenimiento de la aplicación.

## Ejemplo

Archivo `config/routes.rb`:

```ruby
Rails.application.routes.draw do
  # Ruta básica para el controlador 'posts'
  get 'posts', to: 'posts#index'

  # Ruta con parámetro
  get 'posts/:id', to: 'posts#show', as: 'post'

  # Recursos RESTful
  resources :posts
end
```

* `get 'posts', to: 'posts#index'` conecta la URL `/posts` con la acción `index` del controlador `PostsController`.
* `resources :posts` crea automáticamente todas las rutas RESTful (`index`, `show`, `new`, `create`, `edit`, `update`, `destroy`).

## Ventajas

* Centraliza la definición de todas las rutas de la aplicación.
* Facilita la creación de URLs RESTful estándar.
* Permite nombrar rutas para generar helpers en vistas y controladores.
* Mejora la legibilidad y mantenimiento del código.

## Desventajas

* Puede volverse complejo en aplicaciones muy grandes con muchas rutas personalizadas.
* Configuraciones incorrectas pueden causar conflictos o errores de routing.
* Exceso de rutas automáticas (`resources`) puede exponer endpoints innecesarios.

## Ejemplo en producción

En una aplicación de blog en producción:

```ruby
Rails.application.routes.draw do
  root 'home#index' # Página principal
  resources :users, only: [:index, :show, :create]
  resources :posts do
    resources :comments, only: [:create, :destroy]
  end
end
```

* La ruta raíz (`/`) muestra la página principal.
* Los usuarios tienen rutas limitadas a `index`, `show` y `create`.
* Los comentarios están anidados dentro de posts, reflejando la relación padre-hijo.
* Esto garantiza que la aplicación tenga URLs claras, organizadas y seguras para producción.

# Funcionamiento de Routes en Ruby on Rails

## Concepto

En Ruby on Rails, las **routes** no son una clase convencional. Son un **sistema de mapeo** que conecta URLs con acciones de controladores usando un **DSL (Domain-Specific Language)** en el archivo `config/routes.rb`.

## Cómo funciona

1. **Archivo de rutas:** Todo comienza en `config/routes.rb`, donde defines tus rutas dentro de un bloque `Rails.application.routes.draw do ... end`.
2. **Evaluación del bloque:** Rails evalúa este bloque de código durante el arranque de la aplicación. No se instancia una clase por ti, sino que el bloque se ejecuta en el contexto de un objeto interno llamado `ActionDispatch::Routing::RouteSet`.
3. **Creación de objetos internos:** Cada llamada como `get`, `post` o `resources` crea objetos de ruta (`Route`) que contienen la información de URL, método HTTP y controlador/acción asociado.
4. **Matching de solicitudes:** Cuando llega una solicitud HTTP, Rails recorre todas las rutas definidas y busca la que coincide con la URL y el método. Una vez encontrada, invoca la acción correspondiente en el controlador.
5. **Helpers de rutas:** Rails genera automáticamente métodos helper basados en los nombres de rutas (como `posts_path` o `new_post_path`) para que puedas usarlos en vistas y controladores.

## Ejemplo

```ruby
Rails.application.routes.draw do
  get 'posts', to: 'posts#index'
  resources :posts
end
```

* `get 'posts'` genera un objeto interno que mapea `/posts` al método `index` de `PostsController`.
* `resources :posts` genera varias rutas RESTful automáticamente.

## Ventajas

* No necesitas escribir lógica para encontrar el controlador correcto; Rails lo hace automáticamente.
* Centraliza la configuración de URLs.
* Facilita la generación de helpers para vistas.

## Desventajas

* No es intuitivo para quienes esperan una clase tradicional.
* En aplicaciones muy grandes, demasiadas rutas pueden complicar el mantenimiento.

## Resumen

Aunque no sea una clase que hereda de otra, **Rails maneja las rutas mediante un bloque evaluado en un objeto interno (`RouteSet`)**, creando y almacenando rutas como objetos que luego se utilizan para direccionar las solicitudes HTTP hacia los controladores correspondientes.
